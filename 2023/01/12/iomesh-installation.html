<!doctype html><html lang=zh-cn dir=content/zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="upgrade-insecure-requests"><title>IOMESH Installation - 路无止境！</title><meta name=keywords content="博客,架构师,思考,读书,笔记,技术,分享,云"><meta name=author content="Etaon"><meta property="og:title" content="IOMESH Installation"><meta property="og:site_name" content="路无止境！"><meta property="og:image" content="/img/author.jpg"><meta name=title content="IOMESH Installation - 路无止境！"><meta name=description content="欢迎来到ETAON空间站，个人主要专注于Infra系统架构，私有/公有云产品，售前及微服务解决方案。"><link rel="shortcut icon" href=/img/favicon.ico><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=/img/apple-touch-icon.png><link href=//cdn.bootcdn.net/ajax/libs/font-awesome/4.6.2/css/font-awesome.min.css rel=stylesheet type=text/css><link href=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.css rel=stylesheet><link href=/css/main.css rel=stylesheet type=text/css><link href=/css/syntax.css rel=stylesheet type=text/css></head><body itemscope itemtype=http://schema.org/WebPage lang=zh-hans><div class="container one-collumn sidebar-position-left page-home"><div class=headband></div><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button style=opacity:1;top:0><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><div class=multi-lang-switch><i class="fa fa-fw fa-language" style=margin-right:5px></i>
<a class=lang-link id=zh-cn href=#>学习</a></div><div class=custom-logo-site-title><a href=/ class=brand rel=start><span class=logo-line-before><i></i></span>
<span class=site-title>路无止境！</span>
<span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>没有伞的孩子要学会努力奔跑!</p></div><div class=site-nav-right><div class="toggle popup-trigger" style=opacity:1;top:0><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul id=menu class=menu><li class=menu-item><a href=/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class=menu-item><a href=/post rel=section><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class=menu-item><a href=/about.html rel=section><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于我</a></li><li class=menu-item><a href=/404.html rel=section><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益404</a></li><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class=site-search><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class=search-icon><i class="fa fa-search"></i></span>
<span class=popup-btn-close><i class="fa fa-times-circle"></i></span><div class=local-search-input-wrapper><input autocomplete=off placeholder=搜索关键字... spellcheck=false type=text id=local-search-input autocapitalize=none autocorrect=off></div></div><div id=local-search-result></div></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline" style=font-weight:700><a class=post-title-link href=https://www.etaon.top/2023/01/12/iomesh-installation.html itemprop=url>IOMESH Installation</a></h1></header><div class=post-body itemprop=articleBody><h1 id=iomesh-installation>IOMESH Installation</h1><p>官方文档：</p><p><a href=https://docs.iomesh.com/about-iomesh/introduction>Introduction · Documentation</a></p><h2 id=实验拓扑图>实验拓扑图：</h2><p>也可以再测试的时候是使用一个端口，官方建议将IOMESH的端口分可，即下图10.234.1.0/24网段：</p><p><img src=IOMESH%20Installation%20eca8f67062f3435aaa7d92838a929285/Untitled.jpeg alt=Untitled></p><p>实验使用裸机，配置如下：</p><table><thead><tr><th>配件</th><th>型号规格</th><th>数量</th><th>备注</th></tr></thead><tbody><tr><td>CPU</td><td>Intel(R) Xeon(R) Silver 4214R  @ 2.40GHz</td><td>2</td><td>节点1、3</td></tr><tr><td></td><td>Intel(R) Xeon(R) Gold 6226R  @ 2.90GHz</td><td>1</td><td>节点2</td></tr><tr><td>内存</td><td>256 GB</td><td>3</td><td>节点1、2、3</td></tr><tr><td>SSD</td><td>1.6 TB NVMe SSD</td><td>2*3</td><td>节点1/节点2/节点3</td></tr><tr><td>HDD</td><td>2.4 TB SAS</td><td>4*3</td><td>节点1/节点2/节点3</td></tr><tr><td>DOM盘</td><td>M.2 240GB</td><td>2</td><td>节点1/节点2/节点3</td></tr><tr><td>千兆网卡</td><td>I350</td><td>2</td><td>节点1/节点2/节点3</td></tr><tr><td>存储网卡</td><td>10/25G</td><td>2</td><td>节点1/节点2/节点3</td></tr></tbody></table><h2 id=部署iomesh-至少需要一块-cache-disk以及一块-partition-disk>部署IOMesh 至少需要一块 cache disk以及一块 partition disk</h2><hr><h2 id=安装步骤>安装步骤：</h2><h3 id=创建kubernetes集群><strong>创建Kubernetes集群</strong></h3><p>采用Kubernetes 1.24 版本，Runtime为containerd。</p><p>安装参考<a href=https://www.etaon.top/2022/06/6/Install-Kubernetes-1.24.html>Install Kubernetes 1.24 - 路无止境！ (etaon.top)</a></p><h3 id=安装前准备><strong>安装前准备</strong></h3><p>在所有<strong>worker</strong>节点执行以下操作。</p><ol><li>安装 open-iscsi，ubuntu已经安装。</li></ol><p>apt install open-iscsi -y</p><hr><ol start=2><li>编辑iscsi配置文件</li></ol><p>sudo sed -i &rsquo;s/^node.startup = automatic$/node.startup = manual/&rsquo; /etc/iscsi/iscsid.conf</p><hr><ol start=3><li>确保 iscsi_tcp 模块已被加载
sudo modprobe iscsi_tcpsudo bash -c &rsquo;echo iscsi_tcp > /etc/modprobe.d/iscsi-tcp.conf'</li></ol><hr><ol start=4><li>启动 iscsid 服务
systemctl enable &ndash;now iscsid</li></ol><hr><h2 id=离线安装-iomesh><strong>离线安装 IOMesh</strong></h2><p>安装文档：</p><p><a href=https://docs.iomesh.com/deploy/install-iomesh>Install IOMesh · Documentation</a></p><ol><li>下载离线安装文件，将其上传至 <strong>所有</strong> 需要部署 IOMesh 的节点上，包括Master节点。</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#080;font-style:italic>#这个的节点一般指worker节点，且&gt;=3；</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#080;font-style:italic>#如果worker节点不够，希望master节点加入，在master节点执行：</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>kubectl taint nodes --all node-role.kubernetes.io/control-plane- node-role.kubernetes.io/master-<span style=color:#bbb>
</span></span></span></code></pre></div><ol start=2><li>对上传的离线安装包进行解压缩：
tar -xvf  iomesh-offline-v0.11.1.tgz && cd iomesh-offline</li></ol><hr><ol start=3><li>加载镜像文件，Runtime 为 Containerd 的情况下执行以下命令
ctr &ndash;namespace k8s.io image import ./images/iomesh-offline-images.tar</li></ol><hr><ol start=4><li>转到Master 节点（或API Server接入点），生成IOMesh 配置文件
./helm show values charts/iomesh > iomesh.yaml</li></ol><hr><ol start=5><li>定义 iomesh.yaml 配置文件，注意修改 dataCIDR 为 IOMesh 存储网段</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#00f;font-weight:700>...</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>iomesh</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>chunk</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>dataCIDR</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;10.234.1.0/24&#34;</span><span style=color:#bbb> </span><span style=color:#080;font-style:italic># change to your own data network CIDR</span><span style=color:#bbb>
</span></span></span></code></pre></div><hr><ol start=6><li>Master 安装 IOMesh 集群</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>./helm install iomesh ./charts/iomesh \<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>--create-namespace \<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>--namespace iomesh-system \<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>--values iomesh.yaml \<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>--wait<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#080;font-style:italic>#返回结果</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>NAME</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>LAST DEPLOYED</span>:<span style=color:#bbb> </span>Tue Dec 27 09:38:56 2022<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>NAMESPACE</span>:<span style=color:#bbb> </span>iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>STATUS</span>:<span style=color:#bbb> </span>deployed<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>REVISION</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>TEST SUITE</span>:<span style=color:#bbb> </span>None<span style=color:#bbb>
</span></span></span></code></pre></div><hr><ol start=7><li>创建成功以后的POD情况
创建POD过程：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get po -n iomesh-system -w
</span></span><span style=display:flex><span>NAME                                                   READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-ffm5z   6/6     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-nxt62   6/6     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-sv2xq   6/6     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-gr8bm                    3/3     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-kshdt                    3/3     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-xxhhx                    3/3     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-hostpath-provisioner-59v28                      1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-hostpath-provisioner-79dgh                      1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-hostpath-provisioner-cknk8                      1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-openebs-ndm-7vdkm                               1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-openebs-ndm-cluster-exporter-75f568df84-dvz4g   1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-openebs-ndm-hctjc                               1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-openebs-ndm-node-exporter-f59t5                 1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-openebs-ndm-node-exporter-l48dj                 1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-openebs-ndm-node-exporter-sxgjn                 1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-openebs-ndm-operator-7d58d8fbc8-xxwdt           1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-openebs-ndm-x64pj                               1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-zookeeper-0                                     0/1     Running   <span style=color:#666>0</span>          18s
</span></span><span style=display:flex><span>iomesh-zookeeper-operator-f5588b6d7-lrj6n              1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>operator-765dd9678f-95rcw                              1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>operator-765dd9678f-ns2gs                              1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>operator-765dd9678f-q8pwn                              1/1     Running   <span style=color:#666>0</span>          24s
</span></span><span style=display:flex><span>iomesh-zookeeper-0                                     1/1     Running   <span style=color:#666>0</span>          23s
</span></span><span style=display:flex><span>iomesh-zookeeper-1                                     0/1     Pending   <span style=color:#666>0</span>          0s
</span></span><span style=display:flex><span>iomesh-zookeeper-1                                     0/1     Pending   <span style=color:#666>0</span>          1s
</span></span><span style=display:flex><span>iomesh-zookeeper-1                                     0/1     ContainerCreating   <span style=color:#666>0</span>          1s
</span></span><span style=display:flex><span>iomesh-zookeeper-1                                     0/1     ContainerCreating   <span style=color:#666>0</span>          1s
</span></span><span style=display:flex><span>iomesh-zookeeper-1                                     0/1     Running             <span style=color:#666>0</span>          2s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-gr8bm                    3/3     Running             <span style=color:#666>1</span> <span style=color:#666>(</span>0s ago<span style=color:#666>)</span>   50s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-kshdt                    3/3     Running             <span style=color:#666>1</span> <span style=color:#666>(</span>0s ago<span style=color:#666>)</span>   50s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-xxhhx                    3/3     Running             <span style=color:#666>1</span> <span style=color:#666>(</span>0s ago<span style=color:#666>)</span>   50s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-nxt62   2/6     Error               <span style=color:#666>1</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>   53s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-ffm5z   2/6     Error               <span style=color:#666>1</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>   53s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-sv2xq   2/6     Error               <span style=color:#666>1</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>   54s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-nxt62   6/6     Running             <span style=color:#666>5</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>   54s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-ffm5z   6/6     Running             <span style=color:#666>5</span> <span style=color:#666>(</span>2s ago<span style=color:#666>)</span>   54s
</span></span><span style=display:flex><span>iomesh-zookeeper-1                                     1/1     Running             <span style=color:#666>0</span>            26s
</span></span><span style=display:flex><span>iomesh-zookeeper-2                                     0/1     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-sv2xq   6/6     Running             <span style=color:#666>5</span> <span style=color:#666>(</span>2s ago<span style=color:#666>)</span>   55s
</span></span><span style=display:flex><span>iomesh-zookeeper-2                                     0/1     Pending             <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-zookeeper-2                                     0/1     ContainerCreating   <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-zookeeper-2                                     0/1     ContainerCreating   <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-zookeeper-2                                     0/1     Running             <span style=color:#666>0</span>            2s
</span></span><span style=display:flex><span>iomesh-zookeeper-2                                     1/1     Running             <span style=color:#666>0</span>            26s
</span></span><span style=display:flex><span>iomesh-meta-0                                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-meta-1                                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-meta-2                                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-meta-0                                          0/2     Pending             <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-meta-1                                          0/2     Pending             <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-meta-1                                          0/2     Init:0/1            <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-meta-0                                          0/2     Init:0/1            <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-meta-2                                          0/2     Pending             <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-meta-2                                          0/2     Init:0/1            <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-jj2qm                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-jj2qm                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          0/2     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          0/2     Init:0/1            <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          0/2     Init:0/1            <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-chunk-0                                         0/3     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-meta-0                                          0/2     Init:0/1            <span style=color:#666>0</span>            2s
</span></span><span style=display:flex><span>iomesh-meta-1                                          0/2     Init:0/1            <span style=color:#666>0</span>            2s
</span></span><span style=display:flex><span>iomesh-meta-2                                          0/2     Init:0/1            <span style=color:#666>0</span>            2s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          0/2     Init:0/1            <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-jj2qm                          0/2     Init:0/1            <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-chunk-0                                         0/3     Pending             <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-meta-1                                          0/2     Init:0/1            <span style=color:#666>0</span>            3s
</span></span><span style=display:flex><span>iomesh-meta-2                                          0/2     PodInitializing     <span style=color:#666>0</span>            3s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          0/2     PodInitializing     <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-chunk-0                                         0/3     Init:0/1            <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          0/2     PodInitializing     <span style=color:#666>0</span>            2s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          1/2     Running             <span style=color:#666>0</span>            2s
</span></span><span style=display:flex><span>iomesh-meta-0                                          0/2     PodInitializing     <span style=color:#666>0</span>            4s
</span></span><span style=display:flex><span>iomesh-meta-1                                          0/2     PodInitializing     <span style=color:#666>0</span>            4s
</span></span><span style=display:flex><span>iomesh-meta-2                                          1/2     Running             <span style=color:#666>0</span>            4s
</span></span><span style=display:flex><span>iomesh-meta-1                                          1/2     Running             <span style=color:#666>0</span>            5s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-jj2qm                          0/2     PodInitializing     <span style=color:#666>0</span>            3s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          1/2     Error               <span style=color:#666>0</span>            3s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          1/2     Running             <span style=color:#666>0</span>            4s
</span></span><span style=display:flex><span>iomesh-meta-0                                          1/2     Running             <span style=color:#666>0</span>            6s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          1/2     Error               <span style=color:#666>0</span>            4s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          1/2     Running             <span style=color:#666>1</span> <span style=color:#666>(</span>3s ago<span style=color:#666>)</span>   5s
</span></span><span style=display:flex><span>iomesh-meta-0                                          1/2     Running             <span style=color:#666>0</span>            7s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          1/2     Running             <span style=color:#666>1</span> <span style=color:#666>(</span>2s ago<span style=color:#666>)</span>   5s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-jj2qm                          1/2     Running             <span style=color:#666>0</span>            5s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          1/2     Error               <span style=color:#666>1</span> <span style=color:#666>(</span>2s ago<span style=color:#666>)</span>   5s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          1/2     Error               <span style=color:#666>1</span> <span style=color:#666>(</span>3s ago<span style=color:#666>)</span>   5s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-jj2qm                          1/2     Error               <span style=color:#666>0</span>            6s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          1/2     CrashLoopBackOff    <span style=color:#666>1</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>   6s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          1/2     CrashLoopBackOff    <span style=color:#666>1</span> <span style=color:#666>(</span>2s ago<span style=color:#666>)</span>   6s
</span></span><span style=display:flex><span>iomesh-chunk-0                                         0/3     PodInitializing     <span style=color:#666>0</span>            7s
</span></span><span style=display:flex><span>iomesh-chunk-0                                         3/3     Running             <span style=color:#666>0</span>            7s
</span></span><span style=display:flex><span>iomesh-chunk-1                                         0/3     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-jj2qm                          1/2     Running             <span style=color:#666>1</span> <span style=color:#666>(</span>5s ago<span style=color:#666>)</span>   8s
</span></span><span style=display:flex><span>iomesh-chunk-1                                         0/3     Pending             <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-chunk-1                                         0/3     Init:0/1            <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-chunk-1                                         0/3     Init:0/1            <span style=color:#666>0</span>            2s
</span></span><span style=display:flex><span>iomesh-meta-0                                          2/2     Running             <span style=color:#666>0</span>            12s
</span></span><span style=display:flex><span>iomesh-meta-1                                          2/2     Running             <span style=color:#666>0</span>            12s
</span></span><span style=display:flex><span>iomesh-meta-2                                          2/2     Running             <span style=color:#666>0</span>            12s
</span></span><span style=display:flex><span>iomesh-chunk-0                                         2/3     Error               <span style=color:#666>0</span>            11s
</span></span><span style=display:flex><span>iomesh-chunk-1                                         0/3     PodInitializing     <span style=color:#666>0</span>            4s
</span></span><span style=display:flex><span>iomesh-chunk-0                                         3/3     Running             <span style=color:#666>1</span> <span style=color:#666>(</span>2s ago<span style=color:#666>)</span>   12s
</span></span><span style=display:flex><span>iomesh-chunk-1                                         3/3     Running             <span style=color:#666>0</span>            5s
</span></span><span style=display:flex><span>iomesh-chunk-2                                         0/3     Pending             <span style=color:#666>0</span>            0s
</span></span><span style=display:flex><span>iomesh-chunk-2                                         0/3     Pending             <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-chunk-2                                         0/3     Init:0/1            <span style=color:#666>0</span>            1s
</span></span><span style=display:flex><span>iomesh-chunk-2                                         0/3     Init:0/1            <span style=color:#666>0</span>            2s
</span></span><span style=display:flex><span>iomesh-chunk-2                                         0/3     PodInitializing     <span style=color:#666>0</span>            3s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-jj2qm                          2/2     Running             <span style=color:#666>1</span> <span style=color:#666>(</span>13s ago<span style=color:#666>)</span>   16s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-gr8bm                    3/3     Running             <span style=color:#666>2</span> <span style=color:#666>(</span>0s ago<span style=color:#666>)</span>    100s
</span></span><span style=display:flex><span>iomesh-chunk-2                                         3/3     Running             <span style=color:#666>0</span>             4s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-xxhhx                    3/3     Running             <span style=color:#666>2</span> <span style=color:#666>(</span>0s ago<span style=color:#666>)</span>    100s
</span></span><span style=display:flex><span>iomesh-csi-driver-node-plugin-kshdt                    3/3     Running             <span style=color:#666>2</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>    101s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-sv2xq   2/6     Error               <span style=color:#666>6</span> <span style=color:#666>(</span>0s ago<span style=color:#666>)</span>    103s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-nxt62   2/6     Error               <span style=color:#666>6</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>    103s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-ffm5z   2/6     Error               <span style=color:#666>6</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>    103s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-sv2xq   2/6     CrashLoopBackOff    <span style=color:#666>6</span> <span style=color:#666>(</span>1s ago<span style=color:#666>)</span>    104s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-nxt62   2/6     CrashLoopBackOff    <span style=color:#666>6</span> <span style=color:#666>(</span>2s ago<span style=color:#666>)</span>    104s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-ffm5z   2/6     CrashLoopBackOff    <span style=color:#666>6</span> <span style=color:#666>(</span>2s ago<span style=color:#666>)</span>    104s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          1/2     Running             <span style=color:#666>2</span> <span style=color:#666>(</span>18s ago<span style=color:#666>)</span>   23s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          1/2     Running             <span style=color:#666>2</span> <span style=color:#666>(</span>19s ago<span style=color:#666>)</span>   23s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-nxt62   6/6     Running             <span style=color:#666>10</span> <span style=color:#666>(</span>14s ago<span style=color:#666>)</span>   116s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-sv2xq   6/6     Running             <span style=color:#666>10</span> <span style=color:#666>(</span>14s ago<span style=color:#666>)</span>   117s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-zlhtk                          2/2     Running             <span style=color:#666>2</span> <span style=color:#666>(</span>31s ago<span style=color:#666>)</span>    35s
</span></span><span style=display:flex><span>iomesh-iscsi-redirector-9crx8                          2/2     Running             <span style=color:#666>2</span> <span style=color:#666>(</span>30s ago<span style=color:#666>)</span>    35s
</span></span><span style=display:flex><span>iomesh-csi-driver-controller-plugin-6887b8d974-ffm5z   6/6     Running             <span style=color:#666>10</span> <span style=color:#666>(</span>18s ago<span style=color:#666>)</span>   2m
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get po -n iomesh-system -owide<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>NAME                                                   READY   STATUS    RESTARTS         AGE     IP               NODE       NOMINATED NODE   READINESS GATES<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-chunk-0                                         3/3     Running   0                7m27s   192.168.80.23    worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-chunk-1                                         3/3     Running   0                7m20s   192.168.80.22    worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-chunk-2                                         3/3     Running   0                7m16s   192.168.80.21    cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-csi-driver-controller-plugin-6887b8d974-4cjlq   6/6     Running   10 (7m12s ago)   9m10s   192.168.80.22    worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-csi-driver-controller-plugin-6887b8d974-d2d4r   6/6     Running   44 (11m ago)     35m     192.168.80.23    worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-csi-driver-controller-plugin-6887b8d974-j2rks   6/6     Running   44 (11m ago)     35m     192.168.80.21    cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-csi-driver-node-plugin-95f5z                    3/3     Running   14 (7m15s ago)   35m     192.168.80.22    worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-csi-driver-node-plugin-dftlv                    3/3     Running   12 (11m ago)     35m     192.168.80.21    cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-csi-driver-node-plugin-s549x                    3/3     Running   12 (11m ago)     35m     192.168.80.23    worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-hostpath-provisioner-8jvs8                      1/1     Running   1 (8m59s ago)    35m     10.211.5.10      worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-hostpath-provisioner-rkkrs                      1/1     Running   0                35m     10.211.30.71     worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-hostpath-provisioner-rmk4z                      1/1     Running   0                35m     10.211.214.131   cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-iscsi-redirector-6g2fk                          2/2     Running   2 (7m25s ago)    7m30s   192.168.80.22    worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-iscsi-redirector-cxnbq                          2/2     Running   2 (7m25s ago)    7m30s   192.168.80.23    worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-iscsi-redirector-wnglv                          2/2     Running   2 (7m24s ago)    7m30s   192.168.80.21    cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-meta-0                                          2/2     Running   0                7m29s   10.211.30.76     worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-meta-1                                          2/2     Running   0                7m29s   10.211.5.11      worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-meta-2                                          2/2     Running   0                7m29s   10.211.214.135   cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-openebs-ndm-55lgk                               1/1     Running   1 (8m59s ago)    35m     192.168.80.22    worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-openebs-ndm-cluster-exporter-75f568df84-mrd6b   1/1     Running   0                35m     10.211.30.70     worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-openebs-ndm-k7dxn                               1/1     Running   0                35m     192.168.80.23    worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-openebs-ndm-m5p2k                               1/1     Running   0                35m     192.168.80.21    cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-openebs-ndm-node-exporter-2stn9                 1/1     Running   0                35m     10.211.30.72     worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-openebs-ndm-node-exporter-ccfr4                 1/1     Running   0                35m     10.211.214.129   cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-openebs-ndm-node-exporter-jdzdv                 1/1     Running   1 (8m59s ago)    35m     10.211.5.8       worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-openebs-ndm-operator-7d58d8fbc8-plkzz           1/1     Running   0                9m10s   10.211.30.75     worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-zookeeper-0                                     1/1     Running   0                35m     10.211.30.73     worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-zookeeper-1                                     1/1     Running   0                8m14s   10.211.5.9       worker01   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-zookeeper-2                                     1/1     Running   0                7m59s   10.211.214.134   cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-zookeeper-operator-f5588b6d7-wknqk              1/1     Running   0                9m10s   10.211.30.74     worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>operator-765dd9678f-6x5jf                              1/1     Running   0                35m     10.211.30.68     worker02   &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>operator-765dd9678f-h5mzh                              1/1     Running   0                35m     10.211.214.130   cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>operator-765dd9678f-svff4                              1/1     Running   0                9m10s   10.211.214.133   cp01       &lt;none&gt;           &lt;none&gt;<span style=color:#bbb>
</span></span></span></code></pre></div><h1 id=部署-iomesh><strong>部署 IOMesh</strong></h1><h2 id=查看-blockdevice-设备状态><strong>查看 Blockdevice 设备状态</strong></h2><p>IOMesh 安装完成之后，所有的 blockdevice 均处于 Unclaimed 状态</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~# kubectl -n iomesh-system get blockdevice<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>NAME                                           NODENAME   SIZE            CLAIMSTATE   STATUS   AGE<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-02e15a7c78768f42a1e552a3726cff89   worker02   2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-0c6a53344f61d5f4789c393acf459c83   cp01       1600321314816   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-4f6835975745542e4a36b0548a573ef3   cp01       2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-5254ac6aa3528ba39dd3cb18663a1211   cp01       1600321314816   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-5f40eb004d563e77febbde69d930880c   worker01   2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-6e9e9eaafee63535906f3f3b9ab35687   worker01   2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-73f728aca1ab2f74a833303fffc59301   worker01   2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-7401844e99d0b75f2543768a0464e16c   cp01       2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-86ba281ed13da04c83b0d5efba7cbeeb   worker02   1600321314816   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-ad8fe313ea9a4cec2c9ecad4e001e110   worker02   2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-bbe1c0ddda880529f4b19e3f27d2c8b0   worker01   1600321314816   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d017164bd3f69f337e1838cc3b3c4aaf   worker02   2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d116cd6ee3b11542beee3737d03de26a   worker02   1600321314816   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d81eadce662fe037fa84d1ffa4e73a37   worker01   1600321314816   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-de24330f6ca7152c7d9cec70bfa6b3b6   worker01   2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-de6e4ce89275cd799fdf88246c445399   cp01       2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-f19c4d080abe3dbf0b7c7c5600df32a1   worker02   2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-f505ed7231329ab53ebe26e8a00d4483   cp01       2400476553216   Unclaimed    Active   15m<span style=color:#bbb>
</span></span></span></code></pre></div><hr><h2 id=标记磁盘非必须><strong>标记磁盘（非必须）</strong></h2><p>通过以下命令分别对所有缓存盘以及数据盘打上标签，便于后续按照不同功能 claimed。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>缓存盘：<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#080;font-style:italic># kubectl label blockdevice blockdevice-20cce4274e106429525f4a0ca7d192c2 -n iomesh-system iomesh-system/disk=SSD</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>数据盘：<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#080;font-style:italic># kubectl label blockdevice blockdevice-31a2642808ca091a75331b6c7a1f9f68 -n iomesh-system iomesh-system/disk=HDD</span><span style=color:#bbb>
</span></span></span></code></pre></div><hr><h2 id=设备映射-hybridflash><strong>设备映射-HybridFlash</strong></h2><p>iomesh.yaml 文件 chunk/deviceMap 部分用以说明哪些磁盘被 iomesh 所使用以及用以何种类型磁盘进行挂载，本文档进行label select时按照 iomesh-system/disk=SSD 或 HDD 进行区分。</p><p>也可以通过查看磁盘的labels，选择默认的label</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get blockdevice -n iomesh-system blockdevice-02e15a7c78768f42a1e552a3726cff89 -oyaml<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>openebs.io/v1alpha1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>BlockDevice<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>annotations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>internal.openebs.io/uuid-scheme</span>:<span style=color:#bbb> </span>gpt<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>creationTimestamp</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;2022-12-27T09:39:07Z&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>generation</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>labels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>beta.kubernetes.io/arch</span>:<span style=color:#bbb> </span>amd64<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>beta.kubernetes.io/os</span>:<span style=color:#bbb> </span>linux<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>iomesh.com/bd-devicePath</span>:<span style=color:#bbb> </span>dev.sdd<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>iomesh.com/bd-deviceType</span>:<span style=color:#bbb> </span>disk<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>iomesh.com/bd-driverType</span>:<span style=color:#bbb> </span>HDD<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>iomesh.com/bd-model</span>:<span style=color:#bbb> </span>DL2400MM0159<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>iomesh.com/bd-serial</span>:<span style=color:#bbb> </span>5000c500e2476207<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>iomesh.com/bd-vendor</span>:<span style=color:#bbb> </span>SEAGATE<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>kubernetes.io/arch</span>:<span style=color:#bbb> </span>amd64<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>kubernetes.io/hostname</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>kubernetes.io/os</span>:<span style=color:#bbb> </span>linux<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>ndm.io/blockdevice-type</span>:<span style=color:#bbb> </span>blockdevice<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>ndm.io/managed</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;true&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>nodename</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>blockdevice-02e15a7c78768f42a1e552a3726cff89<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>namespace</span>:<span style=color:#bbb> </span>iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>resourceVersion</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;3333&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>uid</span>:<span style=color:#bbb> </span>489546d4-ef39-4980-9fcd-b699a21940ec<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#00f;font-weight:700>...</span>...<span style=color:#bbb>
</span></span></span></code></pre></div><p>如果客户环境中有多个磁盘但有部分磁盘不作为 IOMesh 使用，可以通过 exclude 排除。</p><p>示例：这个选用了我们上面设置的label</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>. . .<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>deviceMap</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>cacheWithJournal</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>selector</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>matchLabels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>iomesh.com/bd-deviceType</span>:<span style=color:#bbb> </span>disk<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>matchExpressions</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span>- <span style=color:green;font-weight:700>key</span>:<span style=color:#bbb> </span>iomesh.com/bd-driverType<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>operator</span>:<span style=color:#bbb> </span>In<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>values</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>- SSD<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:#080;font-style:italic>#    exclude:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:#080;font-style:italic># - blockdevice-097b6628acdcd83a2fc6a5fc9c301e01</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>dataStore</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>selector</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>matchExpressions</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span>- <span style=color:green;font-weight:700>key</span>:<span style=color:#bbb> </span>iomesh.com/bd-driverType<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>operator</span>:<span style=color:#bbb> </span>In<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>values</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>- HDD<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:#080;font-style:italic># exclude: blockdev-xxxx   ### 需要排除的blockdevice</span><span style=color:#bbb>
</span></span></span></code></pre></div><hr><h2 id=申领磁盘><strong>申领磁盘</strong></h2><p>iomesh.yaml 文件修改完成之后通过以下命令完成磁盘申领</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>./helm -n iomesh-system upgrade iomesh charts/iomesh -f iomesh.yaml<span style=color:#bbb>
</span></span></span></code></pre></div><hr><p>执行后查询所有需要用到的磁盘均已处于 Claimed 状态</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get blockdevice -n iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>NAME                                           NODENAME   SIZE            CLAIMSTATE   STATUS   AGE<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-02e15a7c78768f42a1e552a3726cff89   worker02   2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-0c6a53344f61d5f4789c393acf459c83   cp01       1600321314816   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-4f6835975745542e4a36b0548a573ef3   cp01       2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-5254ac6aa3528ba39dd3cb18663a1211   cp01       1600321314816   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-5f40eb004d563e77febbde69d930880c   worker01   2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-6e9e9eaafee63535906f3f3b9ab35687   worker01   2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-73f728aca1ab2f74a833303fffc59301   worker01   2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-7401844e99d0b75f2543768a0464e16c   cp01       2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-86ba281ed13da04c83b0d5efba7cbeeb   worker02   1600321314816   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-ad8fe313ea9a4cec2c9ecad4e001e110   worker02   2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-bbe1c0ddda880529f4b19e3f27d2c8b0   worker01   1600321314816   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d017164bd3f69f337e1838cc3b3c4aaf   worker02   2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d116cd6ee3b11542beee3737d03de26a   worker02   1600321314816   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d81eadce662fe037fa84d1ffa4e73a37   worker01   1600321314816   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-de24330f6ca7152c7d9cec70bfa6b3b6   worker01   2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-de6e4ce89275cd799fdf88246c445399   cp01       2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-f19c4d080abe3dbf0b7c7c5600df32a1   worker02   2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-f505ed7231329ab53ebe26e8a00d4483   cp01       2400476553216   Claimed      Active   5h19m<span style=color:#bbb>
</span></span></span></code></pre></div><hr><h1 id=创建-storageclass><strong>创建 StorageClass</strong></h1><p>接下来就是创建StorageClass的过程。</p><p>这里面涉及到给容器提供持久化存储时 PV - PVC - StorageClass（SC） 的概念。具体的描述可以参见 CNCF 的介绍。给出一个比较浅显的理解</p><ul><li>PV 对应的存储集群中的 Volume。</li><li>PVC 用来声明需要什么类型的存储。当容器需要使用持久化存储资源时通过 PVC 来实现容器和 PV 之间的一个接口。</li><li>在定义 PV 的时候需要配置很多的字段内容，在大规模部署环境中需要创建多个PV较为繁琐。为了简化配置过程，于是就有了动态供给概念 - Dynamic Provisioning，自动创建 PV。管理员可以定义 StorageClass 并部署 PV 配置器（provisioner）。开发人员在申请资源的时候通过 PVC 指定所需的存储类型 - StorageClass，PVC 会把 StorageClass 传递给 PV provisioner，由Provisioner自动创建 PV。</li></ul><p><img src=IOMESH%20Installation%20eca8f67062f3435aaa7d92838a929285/%25E6%2588%25AA%25E5%25B1%258F2023-01-12_11.20.28.png alt="截屏2023-01-12 11.20.28.png"></p><p>IOMesh CSI driver 安装完成之后，会默认安装 Storage Class：iomesh-csi-driver。同时也可以根据需求创建自定义的 StorageClass.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>StorageClass<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>storage.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>iomesh-sc<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>provisioner</span>:<span style=color:#bbb> </span>com.iomesh.csi-driver<span style=color:#bbb> </span><span style=color:#080;font-style:italic># &lt;-- driver.name in iomesh-values.yaml</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>reclaimPolicy</span>:<span style=color:#bbb> </span>Retain<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>allowVolumeExpansion</span>:<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>true</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>parameters</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#080;font-style:italic># &#34;ext4&#34; / &#34;ext3&#34; / &#34;ext2&#34; / &#34;xfs&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>csi.storage.k8s.io/fstype</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;ext4&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#080;font-style:italic># &#34;2&#34; / &#34;3&#34;  </span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>	</span><span style=color:green;font-weight:700>replicaFactor</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;2&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#080;font-style:italic># &#34;true&#34; / &#34;false&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>thinProvision</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;true&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>volumeBindingMode</span>:<span style=color:#bbb> </span>Immediate<span style=color:#bbb>
</span></span></span></code></pre></div><hr><p>示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#00f;font-weight:700>---</span>---<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>StorageClass<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>storage.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>sc-default<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>provisioner</span>:<span style=color:#bbb> </span>com.iomesh.csi-driver<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>reclaimPolicy</span>:<span style=color:#bbb> </span>Delete<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>allowVolumeExpansion</span>:<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>true</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>parameters</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>csi.storage.k8s.io/fstype</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;ext4&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>replicaFactor</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;2&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>thinProvision</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;true&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>volumeBindingMode</span>:<span style=color:#bbb> </span>Immediate<span style=color:#bbb>
</span></span></span></code></pre></div><hr><p>说明：reclaimPolicy 可以设置为 Ratain 或者是 Delete，默认 Delete。在创建PV的时候persistentVolumeReclaimPolicy 会继承 StorageClass 的 reclaimPolicy策略。</p><p>两者的区别在于：</p><p>Delete：通过 PVC-SC 创建的PV，当PVC被删除的时候，PV会一并被删除掉。</p><p>Retain：通过 PVC-SC 创建的PV，当PVC被删除的时候，PV不会被删除掉，会处于Released 状态，可被其他容器使用。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get sc<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>NAME                PROVISIONER                        RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>hostpath            kubevirt.io/hostpath-provisioner   Delete          WaitForFirstConsumer   false                  5h23m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-csi-driver   com.iomesh.csi-driver              Retain          Immediate              true                   5h23m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>sc-default          com.iomesh.csi-driver              Delete          Immediate              true                   47m<span style=color:#bbb>
</span></span></span></code></pre></div><h1 id=创建-snapshotclass><strong>创建 SnapshotClass</strong></h1><p>Kubernetes VolumeSnapshotClass 对象类似于 StorageClass。通过如下方式定义：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>snapshot.storage.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>VolumeSnapshotClass<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>iomesh-csi-driver-default<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>driver</span>:<span style=color:#bbb> </span>com.iomesh.csi-driver<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>deletionPolicy</span>:<span style=color:#bbb> </span>Delete<span style=color:#bbb>
</span></span></span></code></pre></div><hr><h1 id=创建-volume><strong>创建 Volume</strong></h1><p>创建PVC之前需要确保 StorageClass 已经创建完毕。</p><p>示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>PersistentVolumeClaim<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>pvc-test<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>spec:  storageClass<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>Name</span>:<span style=color:#bbb> </span>sc-default   <span style=color:#bbb> </span><span style=color:#080;font-style:italic>## 先前创建的 StorageClass 名称</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>accessModes</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- ReadWriteOnce<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>resources</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>requests</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>storage</span>:<span style=color:#bbb> </span>10Gi<span style=color:#bbb>
</span></span></span></code></pre></div><hr><p>通过上面的PVC创建对应的PV，创建完成之后查询创建完成的PVC：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get pvc<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>NAME             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>iomesh-pvc-10g   Bound    pvc-ac1e1184-a9ce-417e-a7eb-a799cf199be8   10Gi       RWO            sc-default     44m<span style=color:#bbb>
</span></span></span></code></pre></div><hr><p>查询通过PVC 创建的 PV：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get pv<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                   STORAGECLASS   REASON   AGE<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>pvc-5900b5e5-00d4-42ad-821e-6d1199a7e3e3   217Gi      RWO            Delete           Bound    iomesh-system/coredump-iomesh-chunk-0   hostpath                4h55m<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>pvc-ac1e1184-a9ce-417e-a7eb-a799cf199be8   10Gi       RWO            Delete           Bound    default/iomesh-pvc-10g                  sc-default              44m<span style=color:#bbb>
</span></span></span></code></pre></div><hr><h2 id=查看有关cluster的存储情况>查看有关Cluster的存储情况</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get iomeshclusters.iomesh.com -n iomesh-system -oyaml<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>items</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>iomesh.com/v1alpha1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>IOMeshCluster<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>annotations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>meta.helm.sh/release-name</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>meta.helm.sh/release-namespace</span>:<span style=color:#bbb> </span>iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>creationTimestamp</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;2022-12-27T09:38:58Z&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>finalizers</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- iomesh.com/iomesh-cluster-protection<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- iomesh.com/access-protection<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>generation</span>:<span style=color:#bbb> </span><span style=color:#666>4</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>labels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/instance</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/managed-by</span>:<span style=color:#bbb> </span>Helm<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/name</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/part-of</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/version</span>:<span style=color:#bbb> </span>v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>helm.sh/chart</span>:<span style=color:#bbb> </span>iomesh-v0.11.1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>namespace</span>:<span style=color:#bbb> </span>iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>resourceVersion</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;653267&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>uid</span>:<span style=color:#bbb> </span>cd33bce1-9400-4914-aa32-75a13f07d13e<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>spec</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>chunk</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>dataCIDR</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.0</span>/24<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>deviceMap</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>cacheWithJournal</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>selector</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>matchExpressions</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>- <span style=color:green;font-weight:700>key</span>:<span style=color:#bbb> </span>iomesh-system/disk<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:green;font-weight:700>operator</span>:<span style=color:#bbb> </span>In<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:green;font-weight:700>values</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span>- SSD<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>dataStore</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>selector</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>matchExpressions</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>- <span style=color:green;font-weight:700>key</span>:<span style=color:#bbb> </span>iomesh-system/disk<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:green;font-weight:700>operator</span>:<span style=color:#bbb> </span>In<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:green;font-weight:700>values</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span>- HDD<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>devicemanager</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/operator-devicemanager<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v0.11.1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/zbs-chunkd<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>replicas</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>resources</span>:<span style=color:#bbb> </span>{}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>diskDeploymentMode</span>:<span style=color:#bbb> </span>hybridFlash<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>meta</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/zbs-metad<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>replicas</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>resources</span>:<span style=color:#bbb> </span>{}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>portOffset</span>:<span style=color:#bbb> </span>-<span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>probe</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/operator-probe<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v0.11.1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>reclaimPolicy</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>blockdevice</span>:<span style=color:#bbb> </span>Delete<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>volume</span>:<span style=color:#bbb> </span>Delete<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>redirector</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>dataCIDR</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.0</span>/24<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/zbs-iscsi-redirectord<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>resources</span>:<span style=color:#bbb> </span>{}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>storageClass</span>:<span style=color:#bbb> </span>hostpath<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>toolbox</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/operator-toolbox<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v0.11.1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>attachedDevices</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-bbe1c0ddda880529f4b19e3f27d2c8b0<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>cacheWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-02e15a7c78768f42a1e552a3726cff89<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-7401844e99d0b75f2543768a0464e16c<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>cp01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-6e9e9eaafee63535906f3f3b9ab35687<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-5f40eb004d563e77febbde69d930880c<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-de6e4ce89275cd799fdf88246c445399<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>cp01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-d81eadce662fe037fa84d1ffa4e73a37<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>cacheWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-d116cd6ee3b11542beee3737d03de26a<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>cacheWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-f505ed7231329ab53ebe26e8a00d4483<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>cp01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-f19c4d080abe3dbf0b7c7c5600df32a1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-4f6835975745542e4a36b0548a573ef3<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>cp01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-73f728aca1ab2f74a833303fffc59301<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-86ba281ed13da04c83b0d5efba7cbeeb<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>cacheWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-0c6a53344f61d5f4789c393acf459c83<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>cacheWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>cp01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-ad8fe313ea9a4cec2c9ecad4e001e110<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-d017164bd3f69f337e1838cc3b3c4aaf<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-de24330f6ca7152c7d9cec70bfa6b3b6<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStore<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-5254ac6aa3528ba39dd3cb18663a1211<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>cacheWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>cp01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>license</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>expirationDate</span>:<span style=color:#bbb> </span>Thu, 26 Jan 2023 10:07:30 UTC<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>maxChunkNum</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>maxPhysicalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>0</span><span style=color:#bbb> </span>TB<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>maxPhysicalDataCapacityPerNode</span>:<span style=color:#bbb> </span><span style=color:#666>128</span><span style=color:#bbb> </span>TB<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>serial</span>:<span style=color:#bbb> </span><span style=color:#666>44831211</span>-c377-486e-acc5-7b4ea354091e<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>signDate</span>:<span style=color:#bbb> </span>Tue, 27 Dec 2022 10:07:30 UTC<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>softwareEdition</span>:<span style=color:#bbb> </span>COMMUNITY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>subscriptionExpirationDate</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;0&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>subscriptionStartDate</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;0&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>readyReplicas</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>iomesh-chunk</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>iomesh-meta</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>runningImages</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>chunk</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-chunk-0</span>:<span style=color:#bbb> </span>iomesh/zbs-chunkd:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-chunk-1</span>:<span style=color:#bbb> </span>iomesh/zbs-chunkd:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-chunk-2</span>:<span style=color:#bbb> </span>iomesh/zbs-chunkd:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>meta</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-meta-0</span>:<span style=color:#bbb> </span>iomesh/zbs-metad:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-meta-1</span>:<span style=color:#bbb> </span>iomesh/zbs-metad:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-meta-2</span>:<span style=color:#bbb> </span>iomesh/zbs-metad:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>summary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>chunkSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>chunks</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.23</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>193.</span>75Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>87Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>22Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>193.</span>75Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span><span style=color:#666>5.</span>75Gi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>2</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.22</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>87Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>22Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.21</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>193.</span>75Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>87Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>22Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>193.</span>75Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span><span style=color:#666>5.</span>75Gi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>clusterSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>387.</span>50Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>62Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>24.</span>66Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>387.</span>50Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span><span style=color:#666>11.</span>50Gi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>metaSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>aliveHost</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.5.11</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.30.76</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.214.135</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>leader</span>:<span style=color:#bbb> </span><span style=color:#666>10.211.5.11</span>:<span style=color:#666>10100</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>META_RUNNING<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>List<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>resourceVersion</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;&#34;</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>主要查看Summary的内容：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>summary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>chunkSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>chunks</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.23</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>193.</span>75Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>87Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>22Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>193.</span>75Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span><span style=color:#666>5.</span>75Gi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>2</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.22</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>87Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>22Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.21</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>193.</span>75Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>87Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>22Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>193.</span>75Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span><span style=color:#666>5.</span>75Gi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>clusterSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>387.</span>50Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>62Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>24.</span>66Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span><span style=color:#666>387.</span>50Mi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span><span style=color:#666>11.</span>50Gi<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>metaSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>aliveHost</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.5.11</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.30.76</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.214.135</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>leader</span>:<span style=color:#bbb> </span><span style=color:#666>10.211.5.11</span>:<span style=color:#666>10100</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>META_RUNNING<span style=color:#bbb>
</span></span></span></code></pre></div><h2 id=all-flash模式>All Flash模式</h2><p>改变iomesh.yaml文件</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>iomesh</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#080;font-style:italic># Whether to create IOMeshCluster object</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>create</span>:<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>true</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#080;font-style:italic># Use All-Flash Mode or Hybrid-Flash Mode, in All-Flash mode will reject mounting `cacheWithJournal` and `rawCache` type.</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:#080;font-style:italic># And enable mount `dataStoreWithJournal`.</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>diskDeploymentMode</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;allFlash&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#080;font-style:italic>#注意：这个提示没有给出关键词，不是ALL-Flash。应用后会提示错误！</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#080;font-style:italic>#./helm -n iomesh-system upgrade iomesh charts/iomesh -f iomesh.yaml</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#080;font-style:italic>#Error: UPGRADE FAILED: cannot patch &#34;iomesh&#34; with kind IOMeshCluster: IOMeshCluster.iomesh.com &#34;iomesh&#34; is invalid: spec.diskDeploymentMode: Unsupported value: &#34;ALL-Flash&#34;: supported values: &#34;hybridFlash&#34;, &#34;allFlash&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>deviceMap</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#  cacheWithJournal:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#    selector:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#      matchExpressions:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#      - key: iomesh-system/disk</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#        operator: In</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#        values:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#        - SSD</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#  dataStore:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#    selector:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#      matchExpressions:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#      - key: iomesh-system/disk</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#        operator: In</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#        values:</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic>#        - HDD</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>dataStoreWithJournal</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>selector</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>matchLabels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>iomesh.com/bd-deviceType</span>:<span style=color:#bbb> </span>disk<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>matchExpressions</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span>- <span style=color:green;font-weight:700>key</span>:<span style=color:#bbb> </span>iomesh.com/bd-driverType<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>operator</span>:<span style=color:#bbb> </span>In<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>values</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>- SSD<span style=color:#bbb>
</span></span></span></code></pre></div><p>查看CRD的yaml可以看到这部分的配置：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>diskDeploymentMode</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span><span style=color:green;font-weight:700>default</span>:<span style=color:#bbb> </span>hybridFlash<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span><span style=color:green;font-weight:700>description</span>:<span style=color:#bbb> </span>DiskDeploymentMode set this IOMesh cluster start with<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                  </span>all-flash mode or hybrid-flash mode. In all-flash mode, the DeviceManager<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                  </span>will reject mount any `Cache` type partition. In hybrid-flash mode,<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                  </span>the DeviceManager will reject mount `dataStoreWithJournal` type<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                  </span>partition.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span><span style=color:green;font-weight:700>enum</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>- hybridFlash<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span>- allFlash<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>                </span><span style=color:green;font-weight:700>type</span>:<span style=color:#bbb> </span>string<span style=color:#bbb>
</span></span></span></code></pre></div><p>执行以后：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# ./helm -n iomesh-system upgrade iomesh charts/iomesh -f iomesh.yaml<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>Release &#34;iomesh&#34; has been upgraded. Happy Helming!<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>NAME</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>LAST DEPLOYED</span>:<span style=color:#bbb> </span>Wed Dec 28 11:30:02 2022<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>NAMESPACE</span>:<span style=color:#bbb> </span>iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>STATUS</span>:<span style=color:#bbb> </span>deployed<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>REVISION</span>:<span style=color:#bbb> </span><span style=color:#666>8</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>TEST SUITE</span>:<span style=color:#bbb> </span>None<span style=color:#bbb>
</span></span></span></code></pre></div><p>磁盘会重新Claim</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get blockdevice -n iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>NAME                                           NODENAME   SIZE            CLAIMSTATE   STATUS   AGE<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-02e15a7c78768f42a1e552a3726cff89   worker02   2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-0c6a53344f61d5f4789c393acf459c83   cp01       1600321314816   Claimed      Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-4f6835975745542e4a36b0548a573ef3   cp01       2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-5254ac6aa3528ba39dd3cb18663a1211   cp01       1600321314816   Claimed      Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-5f40eb004d563e77febbde69d930880c   worker01   2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-6e9e9eaafee63535906f3f3b9ab35687   worker01   2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-73f728aca1ab2f74a833303fffc59301   worker01   2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-7401844e99d0b75f2543768a0464e16c   cp01       2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-86ba281ed13da04c83b0d5efba7cbeeb   worker02   1600321314816   Claimed      Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-ad8fe313ea9a4cec2c9ecad4e001e110   worker02   2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-bbe1c0ddda880529f4b19e3f27d2c8b0   worker01   1600321314816   Claimed      Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d017164bd3f69f337e1838cc3b3c4aaf   worker02   2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d116cd6ee3b11542beee3737d03de26a   worker02   1600321314816   Claimed      Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-d81eadce662fe037fa84d1ffa4e73a37   worker01   1600321314816   Claimed      Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-de24330f6ca7152c7d9cec70bfa6b3b6   worker01   2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-de6e4ce89275cd799fdf88246c445399   cp01       2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-f19c4d080abe3dbf0b7c7c5600df32a1   worker02   2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>blockdevice-f505ed7231329ab53ebe26e8a00d4483   cp01       2400476553216   Unclaimed    Active   25h<span style=color:#bbb>
</span></span></span></code></pre></div><p>再次查看系统的存储</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# kubectl get iomeshclusters.iomesh.com -n iomesh-system -o yaml<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>items</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>iomesh.com/v1alpha1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>IOMeshCluster<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>annotations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>meta.helm.sh/release-name</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>meta.helm.sh/release-namespace</span>:<span style=color:#bbb> </span>iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>creationTimestamp</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;2022-12-27T09:38:58Z&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>finalizers</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- iomesh.com/iomesh-cluster-protection<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- iomesh.com/access-protection<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>generation</span>:<span style=color:#bbb> </span><span style=color:#666>5</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>labels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/instance</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/managed-by</span>:<span style=color:#bbb> </span>Helm<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/name</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/part-of</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>app.kubernetes.io/version</span>:<span style=color:#bbb> </span>v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>helm.sh/chart</span>:<span style=color:#bbb> </span>iomesh-v0.11.1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>namespace</span>:<span style=color:#bbb> </span>iomesh-system<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>resourceVersion</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;692613&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>uid</span>:<span style=color:#bbb> </span>cd33bce1-9400-4914-aa32-75a13f07d13e<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>spec</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>chunk</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>dataCIDR</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.0</span>/24<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>deviceMap</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>dataStoreWithJournal</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>selector</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>matchExpressions</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span>- <span style=color:green;font-weight:700>key</span>:<span style=color:#bbb> </span>iomesh.com/bd-driverType<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:green;font-weight:700>operator</span>:<span style=color:#bbb> </span>In<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:green;font-weight:700>values</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span>- SSD<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>matchLabels</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>              </span><span style=color:green;font-weight:700>iomesh.com/bd-deviceType</span>:<span style=color:#bbb> </span>disk<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>devicemanager</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/operator-devicemanager<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v0.11.1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/zbs-chunkd<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>replicas</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>resources</span>:<span style=color:#bbb> </span>{}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>diskDeploymentMode</span>:<span style=color:#bbb> </span>allFlash<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>meta</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/zbs-metad<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>replicas</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>resources</span>:<span style=color:#bbb> </span>{}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>portOffset</span>:<span style=color:#bbb> </span>-<span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>probe</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/operator-probe<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v0.11.1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>reclaimPolicy</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>blockdevice</span>:<span style=color:#bbb> </span>Delete<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>volume</span>:<span style=color:#bbb> </span>Delete<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>redirector</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>dataCIDR</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.0</span>/24<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/zbs-iscsi-redirectord<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>resources</span>:<span style=color:#bbb> </span>{}<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>storageClass</span>:<span style=color:#bbb> </span>hostpath<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>toolbox</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>pullPolicy</span>:<span style=color:#bbb> </span>IfNotPresent<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>repository</span>:<span style=color:#bbb> </span>iomesh/operator-toolbox<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>tag</span>:<span style=color:#bbb> </span>v0.11.1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>attachedDevices</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-bbe1c0ddda880529f4b19e3f27d2c8b0<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStoreWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-d81eadce662fe037fa84d1ffa4e73a37<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStoreWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-d116cd6ee3b11542beee3737d03de26a<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStoreWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-86ba281ed13da04c83b0d5efba7cbeeb<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStoreWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>worker02<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-0c6a53344f61d5f4789c393acf459c83<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStoreWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>cp01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>device</span>:<span style=color:#bbb> </span>blockdevice-5254ac6aa3528ba39dd3cb18663a1211<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>mountType</span>:<span style=color:#bbb> </span>dataStoreWithJournal<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>nodeName</span>:<span style=color:#bbb> </span>cp01<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>license</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>expirationDate</span>:<span style=color:#bbb> </span>Thu, 26 Jan 2023 10:07:30 UTC<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>maxChunkNum</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>maxPhysicalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>0</span><span style=color:#bbb> </span>TB<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>maxPhysicalDataCapacityPerNode</span>:<span style=color:#bbb> </span><span style=color:#666>128</span><span style=color:#bbb> </span>TB<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>serial</span>:<span style=color:#bbb> </span><span style=color:#666>44831211</span>-c377-486e-acc5-7b4ea354091e<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>signDate</span>:<span style=color:#bbb> </span>Tue, 27 Dec 2022 10:07:30 UTC<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>softwareEdition</span>:<span style=color:#bbb> </span>COMMUNITY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>subscriptionExpirationDate</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;0&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>subscriptionStartDate</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;0&#34;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>readyReplicas</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>iomesh-chunk</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>iomesh-meta</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>runningImages</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>chunk</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-chunk-0</span>:<span style=color:#bbb> </span>iomesh/zbs-chunkd:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-chunk-1</span>:<span style=color:#bbb> </span>iomesh/zbs-chunkd:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-chunk-2</span>:<span style=color:#bbb> </span>iomesh/zbs-chunkd:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>meta</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-meta-0</span>:<span style=color:#bbb> </span>iomesh/zbs-metad:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-meta-1</span>:<span style=color:#bbb> </span>iomesh/zbs-metad:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>iomesh-meta-2</span>:<span style=color:#bbb> </span>iomesh/zbs-metad:v5.1.2-rc14<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>summary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>chunkSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>chunks</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.23</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>85Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>2</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.22</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>85Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>id</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>ip</span>:<span style=color:#bbb> </span><span style=color:#666>10.234.1.21</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>2.</span>85Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>            </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>CHUNK_STATUS_CONNECTED_HEALTHY<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>clusterSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>spaceInfo</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>dirtyCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>failureCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>failureDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>totalCacheCapacity</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>totalDataCapacity</span>:<span style=color:#bbb> </span><span style=color:#666>8.</span>56Ti<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>usedCacheSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>usedDataSpace</span>:<span style=color:#bbb> </span>0B<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>metaSummary</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>aliveHost</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.5.11</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.30.76</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:#666>10.211.214.135</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>leader</span>:<span style=color:#bbb> </span><span style=color:#666>10.211.5.11</span>:<span style=color:#666>10100</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>status</span>:<span style=color:#bbb> </span>META_RUNNING<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>List<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>resourceVersion</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;&#34;</span><span style=color:#bbb>
</span></span></span></code></pre></div><ul><li>监控用pod</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apiVersion: apps/v1
</span></span><span style=display:flex><span>kind: Deployment
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: pyzbs
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  selector:
</span></span><span style=display:flex><span>    matchLabels:
</span></span><span style=display:flex><span>      app: pyzbs
</span></span><span style=display:flex><span>  replicas: <span style=color:#666>1</span>
</span></span><span style=display:flex><span>  template:
</span></span><span style=display:flex><span>    metadata:
</span></span><span style=display:flex><span>      labels:
</span></span><span style=display:flex><span>        app: pyzbs <span style=color:#080;font-style:italic># has to match .spec.selector.matchLabels</span>
</span></span><span style=display:flex><span>    spec:
</span></span><span style=display:flex><span>      containers:
</span></span><span style=display:flex><span>      - name: pyzbs
</span></span><span style=display:flex><span>        image: iomesh/zbs-client-py-builder:latest
</span></span><span style=display:flex><span>        command: <span style=color:#666>[</span> <span style=color:#b44>&#34;/bin/bash&#34;</span>, <span style=color:#b44>&#34;-c&#34;</span>, <span style=color:#b44>&#34;--&#34;</span> <span style=color:#666>]</span>
</span></span><span style=display:flex><span>        args: <span style=color:#666>[</span> <span style=color:#b44>&#34;while true; do sleep 30; done;&#34;</span> <span style=color:#666>]</span>
</span></span></code></pre></div><h2 id=uninstall>Uninstall</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>root@cp01:~/iomesh-offline# ./helm uninstall -n iomesh-system iomesh<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>These resources were kept due to the resource policy</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[Deployment] iomesh-openebs-ndm-operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[Deployment] iomesh-zookeeper-operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[Deployment] operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[DaemonSet] iomesh-hostpath-provisioner<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[DaemonSet] iomesh-openebs-ndm<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[RoleBinding] iomesh-zookeeper-operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[RoleBinding] iomesh:leader-election<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[Role] iomesh-zookeeper-operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[Role] iomesh:leader-election<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ClusterRoleBinding] iomesh-hostpath-provisioner<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ClusterRoleBinding] iomesh-openebs-ndm<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ClusterRoleBinding] iomesh-zookeeper-operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ClusterRoleBinding] iomesh:manager<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ClusterRole] iomesh-hostpath-provisioner<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ClusterRole] iomesh-openebs-ndm<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ClusterRole] iomesh-zookeeper-operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ClusterRole] iomesh:manager<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ConfigMap] iomesh-openebs-ndm-config<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ServiceAccount] openebs-ndm<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ServiceAccount] zookeeper-operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>[ServiceAccount] iomesh-operator<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>release &#34;iomesh&#34; uninstalled<span style=color:#bbb>
</span></span></span></code></pre></div><h2 id=q1-发现pod在某个node上无法挂载pvc>Q1-发现pod在某个node上无法挂载pvc</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>Warning  FailedMount             5m25s                 kubelet                  Unable to attach or mount volumes: unmounted volumes=[fio-pvc-worker01], unattached volumes=[fio-pvc-worker01 kube-api-access-thpm9]</span>:<span style=color:#bbb> </span>timed out waiting for the condition<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>Warning  FailedMapVolume         66s (x11 over 7m20s)  kubelet                  MapVolume.SetUpDevice failed for volume &#34;pvc-bbe904d5-0362-481b-8ec4-e059c0ac2d52&#34; : rpc error: code = Internal desc = failed to attach &amp;{LunId:8 Initiator:iqn.2020-05.com.iomesh:817dd926-3e0f-4c82-9c02-5e30b8e045c5-59068042-6fff-4700-b0b4-537376943d5f IFace:59068042-6fff-4700-b0b4-537376943d5f Portal:127.0.0.1:3260 TargetIqn:iqn.2016-02.com.smartx:system:ebc8b5ba-7a07-4651-9986-f7ea4fe0121e ChapInfo:&lt;nil&gt;}, failed to iscsiadm  discovery target, command: [iscsiadm -m discovery -t sendtargets -p 127.0.0.1:3260 -I 59068042-6fff-4700-b0b4-537376943d5f -o update], output: iscsiadm: Failed to load module tcp: No such file or directory<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>iscsiadm</span>:<span style=color:#bbb> </span>Could not load transport tcp.Dropping interface 59068042-6fff-4700-b0b4-537376943d5f.<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>, error</span>:<span style=color:#bbb> </span>exit status 21<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>Warning  FailedMount  54s (x2 over 3m9s)  kubelet  Unable to attach or mount volumes: unmounted volumes=[fio-pvc-worker01], unattached volumes=[kube-api-access-thpm9 fio-pvc-worker01]</span>:<span style=color:#bbb> </span>timed out waiting for the condition<span style=color:#bbb>
</span></span></span></code></pre></div><p>重新检查：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#666>1</span>. 编辑iscsi配置文件<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>sudo sed -i &#39;s/^node.startup = automatic$/node.startup = manual/&#39; /etc/iscsi/iscsid.conf<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#00f;font-weight:700>---</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>1</span>. 确保 iscsi_tcp 模块已被加载<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>sudo modprobe iscsi_tcpsudo bash -c &#39;echo iscsi_tcp &gt; /etc/modprobe.d/iscsi-tcp.conf&#39;<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#00f;font-weight:700>---</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:#666>1</span>. 启动 iscsid 服务<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>systemctl enable --now iscsid<span style=color:#bbb>
</span></span></span></code></pre></div></div><footer class=post-footer><div id=wcomments></div></footer></article></section></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target=post-toc-wrap>文章目录</li><li class=sidebar-nav-overview data-target=site-overview>站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=/img/avatar.png alt=Etaon><p class=site-author-name itemprop=name>Etaon</p><p class="site-description motion-element" itemprop=description>Kepp Going!</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/post/><span class=site-state-item-count>75</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>14</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>40</span>
<span class=site-state-item-name>标签</span></a></div></nav><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/etaon target=_blank title=GitHub><i class="fa fa-fw fa-github"></i>
GitHub</a></span>
<span class=links-of-author-item><a href=https://blog.csdn.net/weixin_43394724 target=_blank title=CSDN><i class="fa fa-fw fa-CSDN"></i>
CSDN</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class=links-of-blogroll-title><i class="fa fa-fw fa-globe"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://kubernetes.io/ title=Kubernetes target=_blank>Kubernetes</a></li><li class=links-of-blogroll-item><a href=https://cisco.com/ title=Cisco target=_blank>Cisco</a></li><li class=links-of-blogroll-item><a href=https://www.w3school.com.cn/ title=W3School target=_blank>W3School</a></li><li class=links-of-blogroll-item><a href=https://www.liaoxuefeng.com/ title=廖雪峰 target=_blank>廖雪峰</a></li></ul></div><div class="tagcloud-of-blogroll motion-element tagcloud-of-blogroll-inline"><div class=tagcloud-of-blogroll-title><i class="fa fa-fw fa-tags"></i>
标签云</div><ul class=tagcloud-of-blogroll-list><li class=tagcloud-of-blogroll-item><a href=/tags/mysql>Mysql</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/aws>Aws</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/dql>Dql</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/hadoop>Hadoop</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/nsx-t>Nsx t</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/redis>Redis</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/cicd>Cicd</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/git>Git</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/kubernetes>Kubernetes</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/azure>Azure</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class=post-toc><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#实验拓扑图>实验拓扑图：</a></li><li><a href=#部署iomesh-至少需要一块-cache-disk以及一块-partition-disk>部署IOMesh 至少需要一块 cache disk以及一块 partition disk</a></li><li><a href=#安装步骤>安装步骤：</a><ul><li><a href=#创建kubernetes集群><strong>创建Kubernetes集群</strong></a></li><li><a href=#安装前准备><strong>安装前准备</strong></a></li></ul></li><li><a href=#离线安装-iomesh><strong>离线安装 IOMesh</strong></a></li></ul><ul><li><a href=#查看-blockdevice-设备状态><strong>查看 Blockdevice 设备状态</strong></a></li><li><a href=#标记磁盘非必须><strong>标记磁盘（非必须）</strong></a></li><li><a href=#设备映射-hybridflash><strong>设备映射-HybridFlash</strong></a></li><li><a href=#申领磁盘><strong>申领磁盘</strong></a></li></ul><ul><li><a href=#查看有关cluster的存储情况>查看有关Cluster的存储情况</a></li><li><a href=#all-flash模式>All Flash模式</a></li><li><a href=#uninstall>Uninstall</a></li><li><a href=#q1-发现pod在某个node上无法挂载pvc>Q1-发现pod在某个node上无法挂载pvc</a></li></ul></nav></div></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=copyright><span class=copyright-year>&copy; 2010 - 2023</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=copyright-author>路无止境！</span></div><div class=powered-info><span class=powered-by>Powered by - <a class=powered-link href=//gohugo.io target=_blank title=hugo>Hugo v0.101.0</a></span>
<span class=separator-line>/</span>
<span class=theme-info>Theme by - <a class=powered-link href=//github.com/elkan1788/hugo-theme-next target=_blank>NexT</a></span></div><div class=vistor-info><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<span class=site-uv><i class="fa fa-user"></i>
<span class=busuanzi-value id=busuanzi_value_site_uv></span></span>
<span class=separator-line>/</span>
<span class=site-pv><i class="fa fa-eye"></i>
<span class=busuanzi-value id=busuanzi_value_site_pv></span></span></div><div class=license-info><span class=storage-info>Storage by
<a href=https://www.azure.com/ style=font-weight:700 target=_blank>Azure static web apps</a></span>
<span class=separator-line>/</span>
<span class=license-num><a href target=_blank></a></span></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i>
<span id=scrollpercent><span>0</span>%</span></div></div><script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/2.1.4/jquery.min.js></script>
<script type=text/javascript src=/js/search.js></script>
<script type=text/javascript src=/js/affix.js></script>
<script type=text/javascript src=/js/scrollspy.js></script>
<script type=text/javascript>function detectIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),s=e.indexOf("Edge/");return t>0||n>0||s>0?-1:1}function getCntViewHeight(){var t=$("#content").height(),e=$(window).height(),n=t>e?t-e:$(document).height()-e;return n}function getScrollbarWidth(){var e=$("<div />").addClass("scrollbar-measure").prependTo("body"),t=e[0],n=t.offsetWidth-t.clientWidth;return e.remove(),n}function registerBackTop(){var t=50,e=$(".back-to-top");$(window).on("scroll",function(){e.toggleClass("back-to-top-on",window.pageYOffset>t);var s=$(window).scrollTop(),o=getCntViewHeight(),i=s/o,n=Math.round(i*100),a=n>100?100:n;$("#scrollpercent>span").html(a)}),e.on("click",function(){$("html,body").animate({scrollTop:0,screenLeft:0},800)})}function initScrollSpy(){var e=".post-toc",s=$(e),t=".active-current";s.on("activate.bs.scrollspy",function(){var t=$(e+" .active").last();n(),t.addClass("active-current")}).on("clear.bs.scrollspy",n),$("body").scrollspy({target:e});function n(){$(e+" "+t).removeClass(t.substring(1))}}function initAffix(){var e=$(".header-inner").height(),t=parseInt($(".main").css("padding-bottom"),10),n=e+10;$(".sidebar-inner").affix({offset:{top:n,bottom:t}}),$(document).on("affixed.bs.affix",function(){updateTOCHeight(document.body.clientHeight-100)})}function initTOCDimension(){$(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){var e=document.body.clientHeight-100;updateTOCHeight(e)},0)}),updateTOCHeight(document.body.clientHeight-100);var e,t=getScrollbarWidth();$(".post-toc").css("width","calc(100% + "+t+"px)")}function updateTOCHeight(e){e=e||"auto",$(".post-toc").css("max-height",e)}$(function(){var e,t,n,s,o=$(".header-inner").height()+10;$("#sidebar").css({"margin-top":o}).show(),t=parseInt($("#sidebar").css("margin-top")),n=parseInt($(".sidebar-inner").css("height")),e=t+n,s=$(".content-wrap").height(),s<e&&$(".content-wrap").css("min-height",e),$(".site-nav-toggle").on("click",function(){var e=$(".site-nav"),o=$(".toggle"),t="site-nav-on",i="toggle-close",n=e.hasClass(t),a=n?"slideUp":"slideDown",s=n?"removeClass":"addClass";e.stop()[a]("normal",function(){e[s](t),o[s](i)})}),registerBackTop(),initScrollSpy(),initAffix(),initTOCDimension(),$(".sidebar-nav-toc").click(function(){$(this).addClass("sidebar-nav-active"),$(this).next().removeClass("sidebar-nav-active"),$("."+$(this).next().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)}),$(".sidebar-nav-overview").click(function(){$(this).addClass("sidebar-nav-active"),$(this).prev().removeClass("sidebar-nav-active"),$("."+$(this).prev().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)})})</script><script src=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.js></script>
<script type=text/javascript>$(function(){$(".post-body").viewer()})</script><script type=text/javascript>$(function(){detectIE()>0?$.getScript(document.location.protocol+"//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js",function(){new Waline({el:"#wcomments",visitor:!0,avatar:"wavatar",avatarCDN:"https://sdn.geekzu.org/avatar/",avatarForce:!1,wordLimit:"200",placeholder:" 欢迎留下您的宝贵建议，请填写您的昵称和邮箱便于后续交流. ^_^ ",requiredFields:["nick","mail"],serverURL:"Your WalineSerURL",lang:"zh-cn"})}):$("#wcomments").html("抱歉，Waline插件不支持IE或Edge，建议使用Chrome浏览器。")})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=Your%20AddthisId"></script>
<script>(function(){var t,e=document.createElement("script"),n=window.location.protocol.split(":")[0];n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>